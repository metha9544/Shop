<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flower Shop Manager</title>

<style>
:root{
  --pink:#f8c8dc;
  --purple:#e6d9ff;
  --green:#d9f5e3;
  --bg:#fff7fb;
  --text:#444;
}

body{
  font-family: "Segoe UI", sans-serif;
  background: var(--bg);
  margin:0;
  padding:15px;
  color:var(--text);
}

h1{
  text-align:center;
  color:#c06c9b;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.05);
}

label{
  font-size:14px;
  margin-top:8px;
  display:block;
}

input, select{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:12px;
  border:1px solid #ddd;
  font-size:16px;
}

button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border:none;
  border-radius:14px;
  font-size:16px;
  background:var(--pink);
  cursor:pointer;
}

button.cost{
  background:var(--purple);
}

button.delete{
  background:#ffd6d6;
  padding:6px;
  font-size:14px;
}

.summary{
  display:flex;
  gap:10px;
}

.summary div{
  flex:1;
  padding:10px;
  border-radius:14px;
  text-align:center;
}

.sale{background:var(--green);}
.costSum{background:var(--purple);}
.profit{background:var(--pink);}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th,td{
  padding:8px;
  text-align:center;
  font-size:14px;
}

th{
  background:#f2f2f2;
  border-radius:8px;
}
</style>
</head>

<body>

<h1>üå∏ METIST ‚ú®</h1>

<div class="card">
  <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>

  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
  <input type="text" id="customerName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏¢‡πå">

  <label>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
  <select id="product">
    <option value="‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ">‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ</option>
    <option value="‡∏Å‡∏≥‡πÑ‡∏•">‡∏Å‡∏≥‡πÑ‡∏•</option>
  </select>

  <label>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)</label>
  <input type="number" id="saleAmount">

  <button onclick="addSale()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</button>
</div>

<div class="card">
  <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ / ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</h3>
  <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
  <input type="text" id="costName">

  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
  <input type="number" id="costAmount">

  <button class="cost" onclick="addCost()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
</div>

<div class="card summary">
  <div class="sale">
    <div>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</div>
    <h3 id="totalSale">0</h3>
  </div>
  <div class="costSum">
    <div>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
    <h3 id="totalCost">0</h3>
  </div>
  <div class="profit">
    <div>‡∏Å‡∏≥‡πÑ‡∏£</div>
    <h3 id="profit">0</h3>
  </div>
</div>

<div class="card">
  <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
  <table id="saleTable"></table>
</div>

<div class="card" id="billSection" style="display:none">
  <h3>üßæ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</h3>

  <div id="bill" style="
    background:#fff;
    padding:20px;
    border-radius:16px;
    border:2px dashed #f3b6d4;
    text-align:center;
  ">
    <h2 style="color:#c06c9b;margin:0">üå∏ Flower Shop</h2>
    <p id="billDate"></p>
    <hr>

    <p><b>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</b> <span id="billCustomer"></span></p>
    <p><b>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</b> <span id="billProduct"></span></p>
    <p><b>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô:</b> <span id="billAmount"></span> ‡∏ö‡∏≤‡∏ó</p>

    <hr>
    <p style="font-size:12px;color:#888">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô üíê</p>
  </div>

  <button onclick="saveBillImage()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡∏¥‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
</div>

<canvas id="billCanvas" style="display:none"></canvas>
<div class="card">
  <h3>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
  <table id="costTable"></table>
</div>

<script>
let sales = JSON.parse(localStorage.getItem("sales")) || [];
let costs = JSON.parse(localStorage.getItem("costs")) || [];

function save(){
  localStorage.setItem("sales",JSON.stringify(sales));
  localStorage.setItem("costs",JSON.stringify(costs));
  render();
}

function today(){
  return new Date().toLocaleDateString("th-TH");
}

function addSale(){
  let amount = Number(saleAmount.value);
  if(!amount) return;

  sales.push({
    customer: customerName.value || "-",
    product: product.value,
    amount,
    date: today()
  });

  customerName.value="";
  saleAmount.value="";
  save();
}

function addCost(){
  let amount = Number(costAmount.value);
  if(!amount) return;

  costs.push({
    name: costName.value || "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢",
    amount,
    date: today()
  });

  costName.value="";
  costAmount.value="";
  save();
}

function delSale(i){
  sales.splice(i,1);
  save();
}

function delCost(i){
  costs.splice(i,1);
  save();
}

function render(){
  let saleTotal = sales.reduce((s,x)=>s+x.amount,0);
  let costTotal = costs.reduce((s,x)=>s+x.amount,0);

  totalSale.textContent = saleTotal.toLocaleString();
  totalCost.textContent = costTotal.toLocaleString();
  profit.textContent = (saleTotal - costTotal).toLocaleString();

  saleTable.innerHTML = `
    <tr>
      <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
      <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
      <th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
      <th>‡∏¢‡∏≠‡∏î</th>
      <th></th>
    </tr>
    ${sales.map((s,i)=>`
      <tr>
        <td>${s.date}</td>
        <td>${s.customer}</td>
        <td>${s.product}</td>
        <td>${s.amount}</td>
       <td>
  <button class="delete" onclick="delSale(${i})">‡∏•‡∏ö</button>
  <button onclick="showBill(${i})">üßæ</button>
</td>
      </tr>`).join("")}
  `;

  costTable.innerHTML = `
    <tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th>‡∏¢‡∏≠‡∏î</th><th></th></tr>
    ${costs.map((c,i)=>`
      <tr>
        <td>${c.date}</td>
        <td>${c.name}</td>
        <td>${c.amount}</td>
        <td><button class="delete" onclick="delCost(${i})">‡∏•‡∏ö</button></td>
      </tr>`).join("")}
  `;
}

render();
function showBill(i){
  let s = sales[i];
  document.getElementById("billSection").style.display="block";

  billDate.textContent = "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: " + s.date;
  billCustomer.textContent = s.customer;
  billProduct.textContent = s.product;
  billAmount.textContent = s.amount.toLocaleString();

  window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"});
}

function saveBillImage(){
  let bill = document.getElementById("bill");
  let canvas = document.getElementById("billCanvas");
  let ctx = canvas.getContext("2d");

  let scale = 2;
  canvas.width = bill.offsetWidth * scale;
  canvas.height = bill.offsetHeight * scale;
  ctx.scale(scale, scale);

  ctx.fillStyle = "#fff";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.font = "16px sans-serif";
  ctx.fillStyle = "#444";

  let y = 30;
  bill.querySelectorAll("h2,p").forEach(el=>{
    ctx.fillText(el.innerText,20,y);
    y += 30;
  });

  let link = document.createElement("a");
  link.download = "bill.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}
</script>

</body>
</html>