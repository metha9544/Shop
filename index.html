<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Runic Tiling Staggered</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a1a; color: #eee; display: flex; justify-content: center; padding: 20px; }
        .card { background: #252525; padding: 25px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.6); width: 100%; max-width: 500px; border: 1px solid #333; }
        h3 { text-align: center; color: #00ffcc; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px; }
        
        .control-group { margin-bottom: 15px; }
        label { font-size: 13px; color: #888; display: block; margin-bottom: 5px; }
        
        input[type="text"], input[type="number"], input[type="color"] { width: 100%; padding: 12px; background: #333; border: 1px solid #444; border-radius: 10px; color: white; box-sizing: border-box; }
        input[type="color"] { height: 45px; cursor: pointer; padding: 5px; }
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        input[type="range"] { width: 100%; accent-color: #00ffcc; cursor: pointer; }
        
        button { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn-gen { background: #00ffcc; color: #000; }
        .btn-dl { background: #28a745; color: white; margin-top: 10px; }
        button:hover { opacity: 0.8; transform: translateY(-1px); }

        #canvas-wrap { 
            margin-top: 20px; 
            border: 2px solid #333; 
            border-radius: 10px;
            background-color: #000;
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
            max-height: 400px;
            overflow: auto;
        }
        canvas { display: block; margin: 0 auto; }
    </style>
</head>
<body>

<div class="card">
    <h3>Runic Staggered Grid</h3>
    
    <div class="row">
        <div class="control-group">
            <label>กว้าง (cm)</label>
            <input type="number" id="wCm" value="10">
        </div>
        <div class="control-group">
            <label>สูง (cm)</label>
            <input type="number" id="hCm" value="10">
        </div>
    </div>

    <div class="control-group">
        <label>อักษรรูน (เช่น ᚠ ᚢ ᚦ)</label>
        <input type="text" id="txt" value="ᚠ ᚢ ᚦ">
    </div>

    <div class="row">
        <div class="control-group">
            <label>สีลายน้ำ</label>
            <input type="color" id="colorPicker" value="#00ffcc">
        </div>
        <div class="control-group">
            <label>ความหนา (Weight)</label>
            <input type="range" id="weight" min="100" max="900" step="100" value="600">
        </div>
    </div>

    <div class="row">
        <div class="control-group">
            <label>ความจาง (Opacity)</label>
            <input type="range" id="opac" min="0.05" max="1" step="0.05" value="0.3">
        </div>
        <div class="control-group">
            <label>ความถี่ (Density)</label>
            <input type="range" id="density" min="40" max="150" step="10" value="80">
        </div>
    </div>

    <button class="btn-gen" onclick="draw()">สร้างลายน้ำสลับฟันปลา</button>
    <button class="btn-dl" onclick="download()">ดาวน์โหลด PNG</button>

    <div id="canvas-wrap">
        <canvas id="cvs"></canvas>
    </div>
</div>

<script>
    const cvs = document.getElementById('cvs');
    const ctx = cvs.getContext('2d');

    function hexToRgba(hex, opacity) {
        let r = parseInt(hex.slice(1, 3), 16);
        let g = parseInt(hex.slice(3, 5), 16);
        let b = parseInt(hex.slice(5, 7), 16);
        return `rgba(${r}, ${g}, ${b}, ${opacity})`;
    }

    function draw() {
        const pxW = Math.round(document.getElementById('wCm').value * 37.8);
        const pxH = Math.round(document.getElementById('hCm').value * 37.8);
        const runeArray = document.getElementById('txt').value.trim().split(/\s+/);
        
        const opacity = document.getElementById('opac').value;
        const weight = document.getElementById('weight').value;
        const color = document.getElementById('colorPicker').value;
        const step = parseInt(document.getElementById('density').value);

        cvs.width = pxW;
        cvs.height = pxH;
        ctx.clearRect(0, 0, pxW, pxH);

        ctx.fillStyle = hexToRgba(color, opacity);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';

        let rowIndex = 0;
        // วางแนวตั้ง (Y)
        for (let y = 0; y < pxH + step; y += step * 0.8) {
            // เลื่อน X สลับแถว (ฟันปลา)
            let offsetX = (rowIndex % 2 === 0) ? 0 : step / 2;
            
            // วางแนวนอน (X)
            for (let x = 0; x < pxW + step; x += step) {
                // สุ่มเลือกรูน 1 ตัวจากรายการ
                const rune = runeArray[Math.floor(Math.random() * runeArray.length)];
                
                ctx.save();
                ctx.translate(x + offsetX, y);
                
                // สุ่มขนาด (ใหญ่-เล็ก) 
                const randomScale = 0.6 + Math.random() * 0.8; // สุ่มระหว่าง 0.6x ถึง 1.4x
                const fontSize = 24 * randomScale;
                ctx.font = `${weight} ${fontSize}px "Segoe UI", sans-serif`;
                
                // สุ่มมุมหมุนเล็กน้อย (-15 ถึง 15 องศา) เพื่อความเป็นธรรมชาติ
                ctx.rotate((Math.random() * 30 - 15) * Math.PI / 180);
                
                ctx.fillText(rune, 0, 0);
                ctx.restore();
            }
            rowIndex++;
        }
    }

    function download() {
        const link = document.createElement('a');
        link.download = 'staggered-runes.png';
        link.href = cvs.toDataURL('image/png');
        link.click();
    }

    draw(); // รันครั้งแรก
</script>

</body>
</html>
