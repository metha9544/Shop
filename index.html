<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flower Shop Manager - METIST</title>

<style>
:root{
  --pink:#f8c8dc;
  --purple:#e6d9ff;
  --green:#d9f5e3;
  --bg:#fff7fb;
  --text:#444;
}

body{
  font-family: "Segoe UI", sans-serif;
  background: var(--bg);
  margin:0;
  padding:15px;
  color:var(--text);
}

h1{
  text-align:center;
  color:#c06c9b;
  margin-bottom: 5px;
}
.subtitle{
  font-size:14px;
  color:#b08968;
  text-align:center;
  margin-bottom: 20px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.05);
}

label{
  font-size:14px;
  margin-top:8px;
  display:block;
}

input, select{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:12px;
  border:1px solid #ddd;
  font-size:16px;
  box-sizing: border-box;
}

button{
  width:100%;
  margin-top:10px;
  padding:12px;
  border:none;
  border-radius:14px;
  font-size:16px;
  background:var(--pink);
  cursor:pointer;
  font-weight: bold;
}

button.cost{
  background:var(--purple);
}

button.delete{
  background:#ffd6d6;
  padding:6px;
  font-size:12px;
  width: auto;
  margin-top: 0;
}

.summary{
  display:flex;
  gap:10px;
}

.summary div{
  flex:1;
  padding:10px;
  border-radius:14px;
  text-align:center;
}

.sale{background:var(--green);}
.costSum{background:var(--purple);}
.profit{background:var(--pink);}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th,td{
  padding:8px;
  text-align:center;
  font-size:14px;
  border-bottom: 1px solid #eee;
}

th{
  background:#f2f2f2;
  border-radius:8px;
}
</style>
</head>

<body>

<h1>üå∏ METIST ‚ú®</h1>
<div class="subtitle">FLOWER & LUCK</div>

<div class="card">
  <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>

  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
  <input type="text" id="customerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">

  <label>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
  <select id="product" onchange="updateInput()">
    <option value="‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ">‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ</option>
    <option value="‡∏Å‡∏≥‡πÑ‡∏•">‡∏Å‡∏≥‡πÑ‡∏•</option>
  </select>

  <label id="labelDynamic">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å</label>
  <input type="text" id="flowerQuantity" placeholder="‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å" value="">

  <label>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)</label>
  <input type="number" id="saleAmount">

  <button onclick="addSale()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</button>
</div>

<div class="card">
  <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ / ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</h3>
  <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
  <input type="text" id="costName">

  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
  <input type="number" id="costAmount">

  <button class="cost" onclick="addCost()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
</div>

<div class="card summary">
  <div class="sale">
    <div>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</div>
    <h3 id="totalSale">0</h3>
  </div>
  <div class="costSum">
    <div>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
    <h3 id="totalCost">0</h3>
  </div>
  <div class="profit">
    <div>‡∏Å‡∏≥‡πÑ‡∏£</div>
    <h3 id="profit">0</h3>
  </div>
</div>

<div class="card">
  <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
  <table id="saleTable"></table>
</div>

<div class="card" id="billSection" style="display:none">
  <h3>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</h3>
  <div id="bill" style="
    background:#fff;
    padding:20px;
    border-radius:16px;
    border:2px dashed #f3b6d4;
    text-align:center;
  ">
    <h2 style="color:#c06c9b; margin:0; text-align:center;">üå∏ METIST ‚ú®</h2>
    <p class="subtitle" style="text-align:center; margin-bottom: 10px;">FLOWER & LUCK</p>
    <p id="billDate" style="text-align:center; font-size: 14px;"></p>
    <hr style="border: 0.5px solid #eee;">

    <div style="text-align: left; display: inline-block; width: 100%; max-width: 250px; margin: 0 auto;">
        <p style="margin: 5px 0;"><b>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</b> <span id="billCustomer"></span></p>
        <p style="margin: 5px 0;"><b>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</b> <span id="billProduct"></span></p>
        <p style="margin: 5px 0;"><b id="billLabelType">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</b> <span id="billflowerQuantity"></span></p>
        <p style="margin: 5px 0;"><b>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô:</b> <span id="billAmount"></span> ‡∏ö‡∏≤‡∏ó</p>
    </div>

   <div style="margin: 15px 0;">
    <p style="font-size: 12px; color: #555; margin-bottom: 5px;">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
    <img src="qr.png"
         alt="QR Code" 
         style="width: 150px; height: auto; border: 1px solid #eee; padding: 5px; border-radius: 8px;">
</div>

    <hr style="border: 0.5px solid #eee;">
    <p style="font-size:12px;color:#888; text-align:center;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô üíê</p>
  </div>
</div>

<div class="card">
  <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
  <table id="costTable"></table>
</div>

<script>
let sales = JSON.parse(localStorage.getItem("sales")) || [];
let costs = JSON.parse(localStorage.getItem("costs")) || [];

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö Label
function updateInput() {
  const productType = document.getElementById("product").value;
  const label = document.getElementById("labelDynamic");
  const input = document.getElementById("flowerQuantity");

  if (productType === "‡∏Å‡∏≥‡πÑ‡∏•") {
    label.innerText = "‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";
    input.placeholder = "‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏µ‡πâ‡∏´‡∏±‡∏ß‡πÉ‡∏à, ‡∏°‡∏∏‡∏Å";
    input.type = "text";
    input.value = "";
  } else {
    label.innerText = "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å";
    input.placeholder = "‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å";
    input.type = "number";
    input.value = "1";
  }
}

function save(){
  localStorage.setItem("sales",JSON.stringify(sales));
  localStorage.setItem("costs",JSON.stringify(costs));
  render();
}

function today(){
  return new Date().toLocaleDateString("th-TH");
}

function addSale(){
  let amount = Number(saleAmount.value);
  let detail = flowerQuantity.value || (product.value === "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ" ? "1" : "-"); 
  
  if(!amount) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢");
      return;
  }

  sales.push({
    customer: customerName.value || "-",
    product: product.value,
    quantity: detail,
    amount: amount,
    date: today()
  });

  // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤
  customerName.value="";
  saleAmount.value="";
  updateInput(); // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ä‡πà‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  save();
}

function addCost(){
  let amount = Number(costAmount.value);
  if(!amount) return;

  costs.push({
    name: costName.value || "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢",
    amount,
    date: today()
  });

  costName.value="";
  costAmount.value="";
  save();
}

function delSale(i){
  sales.splice(i,1);
  save();
}

function delCost(i){
  costs.splice(i,1);
  save();
}

function render(){
  let saleTotal = sales.reduce((s,x)=>s+x.amount,0);
  let costTotal = costs.reduce((s,x)=>s+x.amount,0);

  totalSale.textContent = saleTotal.toLocaleString();
  totalCost.textContent = costTotal.toLocaleString();
  profit.textContent = (saleTotal - costTotal).toLocaleString();

  saleTable.innerHTML = `
    <tr>
      <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
      <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
      <th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)</th>
      <th>‡∏¢‡∏≠‡∏î</th>
      <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
    </tr>
    ${sales.map((s,i)=>`
      <tr>
        <td>${s.date}</td>
        <td>${s.customer}</td>
        <td>${s.product} (${s.quantity})</td>
        <td>${s.amount.toLocaleString()}</td>
        <td>
          <button class="delete" onclick="delSale(${i})">‡∏•‡∏ö</button>
          <button style="width:auto; padding:5px 10px; margin:0;" onclick="showBill(${i})">üßæ</button>
        </td>
      </tr>`).join("")}
  `;

  costTable.innerHTML = `
    <tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th>‡∏¢‡∏≠‡∏î</th><th></th></tr>
    ${costs.map((c,i)=>`
      <tr>
        <td>${c.date}</td>
        <td>${c.name}</td>
        <td>${c.amount.toLocaleString()}</td>
        <td><button class="delete" onclick="delCost(${i})">‡∏•‡∏ö</button></td>
      </tr>`).join("")}
  `;
}

function showBill(i){
  let s = sales[i];
  document.getElementById("billSection").style.display="block";

  // ‡∏™‡∏•‡∏±‡∏ö‡∏Ñ‡∏≥‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
  const billLabelType = document.getElementById("billLabelType");
  billLabelType.innerText = (s.product === "‡∏Å‡∏≥‡πÑ‡∏•") ? "‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á:" : "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:";

  document.getElementById("billDate").textContent = "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: " + s.date;
  document.getElementById("billCustomer").textContent = s.customer;
  document.getElementById("billProduct").textContent = s.product;
  document.getElementById("billflowerQuantity").textContent = s.quantity;
  document.getElementById("billAmount").textContent = s.amount.toLocaleString();

  window.scrollTo({top: document.getElementById("billSection").offsetTop, behavior:"smooth"});
}

render();
</script>

</body>
</html>
